!function(d){function c(t){a&&(a.resolve(),a=void 0,t.removeData("yiiSubmitFinalizePromise"))}d.fn.yiiActiveForm=function(t){return m[t]?m[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?(d.error("Method "+t+" does not exist on jQuery.yiiActiveForm"),!1):m.init.apply(this,arguments)};var a,i="beforeValidate",o="afterValidate",v="beforeValidateAttribute",u="afterValidateAttribute",n="beforeSubmit",h="ajaxBeforeSend",f="ajaxComplete",r="afterInit",s={encodeErrorSummary:!0,errorSummary:".error-summary",validateOnSubmit:!0,errorCssClass:"has-error",successCssClass:"has-success",validatingCssClass:"validating",ajaxParam:"ajax",ajaxDataType:"json",validationUrl:void 0,scrollToError:!0,scrollToErrorOffset:0,validationStateOn:"container"},l={id:void 0,name:void 0,container:void 0,input:void 0,error:".help-block",encodeError:!0,validateOnChange:!0,validateOnBlur:!0,validateOnType:!1,validationDelay:500,enableAjaxValidation:!1,validate:void 0,status:0,cancelled:!1,value:void 0,updateAriaInvalid:!0},m={init:function(e,a){return this.each(function(){var t,i=d(this);i.data("yiiActiveForm")||(void 0===(t=d.extend({},s,a||{})).validationUrl&&(t.validationUrl=i.attr("action")),d.each(e,function(t){e[t]=d.extend({value:E(i,this)},l,this),g(i,e[t])}),i.data("yiiActiveForm",{settings:t,attributes:e,submitting:!1,validated:!1,validate_only:!1,options:j(i)}),i.on("reset.yiiActiveForm",m.resetForm),t.validateOnSubmit&&(i.on("mouseup.yiiActiveForm keyup.yiiActiveForm",":submit",function(){i.data("yiiActiveForm").submitObject=d(this)}),i.on("submit.yiiActiveForm",m.submitForm)),t=d.Event(r),i.trigger(t))})},add:function(t){var i=d(this);t=d.extend({value:E(i,t)},l,t),i.data("yiiActiveForm").attributes.push(t),g(i,t)},remove:function(i){var t=d(this),e=t.data("yiiActiveForm").attributes,a=-1,n=void 0;return d.each(e,function(t){if(e[t].id==i)return n=e[a=t],!1}),0<=a&&(e.splice(a,1),y(t,n)),n},validateAttribute:function(t){t=m.find.call(this,t);null!=t&&b(d(this),t,!0)},find:function(i){var e=d(this).data("yiiActiveForm").attributes,a=void 0;return d.each(e,function(t){if(e[t].id==i)return a=e[t],!1}),a},destroy:function(){return this.each(function(){d(this).off(".yiiActiveForm"),d(this).removeData("yiiActiveForm")})},data:function(){return this.data("yiiActiveForm")},validate:function(t){t&&(d(this).data("yiiActiveForm").submitting=!0);var r=d(this),s=r.data("yiiActiveForm"),o=!1,u={},l=C(),a=s.submitting;if(a){t=d.Event(i);if(r.trigger(t,[u,l]),!1===t.result)return s.submitting=!1,void c(r)}d.each(s.attributes,function(){this.$form=r;var t=D(r,this);if(t.toArray().reduce(function(t,i){return t&&d(i).is(":disabled")},!0))return!0;if(t.length&&"select"===t[0].tagName.toLowerCase()){var i=t[0].options,e=!i||!i.length,a=t.attr("required"),n=t.attr("multiple"),t=t.attr("size")||1;if(a&&!n&&1===parseInt(t,10)){if(e)return!0;if(i[0]&&""!==i[0].value&&""!==i[0].text)return!0}}this.cancelled=!1,!s.submitting&&2!==this.status&&3!==this.status||(void 0===(e=u[this.id])&&(e=[],u[this.id]=e),i=d.Event(v),r.trigger(i,[this,e,l]),!1!==i.result?(this.validate&&this.validate(this,E(r,this),e,l,r),this.enableAjaxValidation&&(o=!0)):this.cancelled=!0)}),d.when.apply(this,l).always(function(){for(var t in u)0===u[t].length&&delete u[t];var i,e;o&&(d.isEmptyObject(u)||s.submitting)?(i=s.submitObject,e="&"+s.settings.ajaxParam+"="+r.attr("id"),i&&i.length&&i.attr("name")&&(e+="&"+i.attr("name")+"="+i.attr("value")),d.ajax({url:s.settings.validationUrl,type:r.attr("method"),data:r.serialize()+e,dataType:s.settings.ajaxDataType,complete:function(t,i){r.trigger(f,[t,i])},beforeSend:function(t,i){r.trigger(h,[t,i])},success:function(t){null!==t&&"object"==typeof t?(d.each(s.attributes,function(){this.enableAjaxValidation&&!this.cancelled||delete t[this.id]}),O(r,d.extend(u,t),a)):O(r,u,a)},error:function(){s.submitting=!1,c(r)}})):s.submitting?window.setTimeout(function(){O(r,u,a)},200):O(r,u,a)})},submitForm:function(){var t=d(this),i=t.data("yiiActiveForm");if(i.validated){i.submitting=!1;var e=d.Event(n);return(t.trigger(e),!1===e.result)?(i.validated=!1,c(t),!1):(w(t),!0)}return e=t,a=d.Deferred(),e.data("yiiSubmitFinalizePromise",a.promise()),void 0!==i.settings.timer&&clearTimeout(i.settings.timer),i.submitting=!0,m.validate.call(t),!1},resetForm:function(){var e=d(this),a=e.data("yiiActiveForm");window.setTimeout(function(){d.each(a.attributes,function(){this.value=E(e,this),this.status=0;var t=e.find(this.container),i=D(e,this);("input"===a.settings.validationStateOn?i:t).removeClass(a.settings.validatingCssClass+" "+a.settings.errorCssClass+" "+a.settings.successCssClass),t.find(this.error).html("")}),e.find(a.settings.errorSummary).hide().find("ul").html("")},1)},updateMessages:function(t,i){var e=d(this),a=e.data("yiiActiveForm");d.each(a.attributes,function(){x(e,this,t)}),i&&S(e,t)},updateAttribute:function(t,i){var e,a=m.find.call(this,t);null!=a&&((e={})[t]=i,x(d(this),a,e))}},g=function(i,e){var t=D(i,e);e.validateOnChange&&t.on("change.yiiActiveForm",function(){b(i,e,!1)}),e.validateOnBlur&&t.on("blur.yiiActiveForm",function(){0!=e.status&&1!=e.status||b(i,e,!0)}),e.validateOnType&&t.on("keyup.yiiActiveForm",function(t){-1===d.inArray(t.which,[16,17,18,37,38,39,40])&&e.value!==E(i,e)&&b(i,e,!1,e.validationDelay)})},y=function(t,i){D(t,i).off(".yiiActiveForm")},b=function(e,t,i,a){var n=e.data("yiiActiveForm");i&&(t.status=2),d.each(n.attributes,function(){p(this.value,E(e,this))||(this.status=2,i=!0)}),i&&(void 0!==n.settings.timer&&clearTimeout(n.settings.timer),n.settings.timer=window.setTimeout(function(){n.submitting||e.is(":hidden")||(d.each(n.attributes,function(){var t,i;2===this.status&&(this.status=3,t=e.find(this.container),i=D(e,this),("input"===n.settings.validationStateOn?i:t).addClass(n.settings.validatingCssClass))}),m.validate.call(e))},a||200))},p=function(t,i){return t instanceof Object?e(t,i):Array.isArray(t)?A(t,i):t===i},e=function(t,i){if(!(t instanceof Object&&i instanceof Object))return!1;var e=Object.keys(t),a=Object.keys(i);if(e.length!==a.length)return!1;for(var n=0;n<e.length;n+=1){if(!i.hasOwnProperty(e[n]))return!1;if(t[e[n]]!==i[e[n]])return!1}return!0},A=function(t,i){if(!Array.isArray(t)||!Array.isArray(i))return!1;if(t.length!==i.length)return!1;for(var e=0;e<t.length;e+=1)if(t[e]!==i[e])return!1;return!0},C=function(){var t=[];return t.add=function(t){this.push(new d.Deferred(t))},t},F=["action","target","method","enctype"],j=function(t){for(var i={},e=0;e<F.length;e++)i[F[e]]=t.attr(F[e]);return i},O=function(i,e,a){var t=i.data("yiiActiveForm");if(void 0===t)return!1;var n,r,s=[];d.each(t.attributes,function(){var t=a&&x(i,this,e)||!a&&T(i,this,e);D(i,this).is(":disabled")||this.cancelled||!t||s.push(this)}),i.trigger(o,[e,s]),a?(S(i,e),s.length?(t.settings.scrollToError&&(r=d(document).height(),((n=(n=i.find(d.map(s,function(t){return t.input}).join(",")).first().closest(":visible").offset().top-t.settings.scrollToErrorOffset)<0?0:r<n?r:n)<(r=d(window).scrollTop())||n>r+d(window).height())&&d(window).scrollTop(n)),t.submitting=!1):(t.validated=!0,t.validate_only||(t.submitObject&&function(t,i){for(var e=0;e<F.length;e++){var a=i.attr("form"+F[e]);a&&t.attr(F[e],a)}}(i,t.submitObject),i.submit(),t.submitObject&&function(t){for(var i=t.data("yiiActiveForm"),e=0;e<F.length;e++)t.attr(F[e],i.options[F[e]]||null)}(i)))):d.each(t.attributes,function(){this.cancelled||2!==this.status&&3!==this.status||x(i,this,e)}),c(i)},w=function(t){var i,e=t.data("yiiActiveForm").submitObject||t.find(":submit:first");e.length&&"submit"==e.attr("type")&&e.attr("name")&&((i=d('input[type="hidden"][name="'+e.attr("name")+'"]',t)).length?i.attr("value",e.attr("value")):d("<input>").attr({type:"hidden",name:e.attr("name"),value:e.attr("value")}).appendTo(t))},x=function(t,i,e){var a,n,r=t.data("yiiActiveForm"),s=D(t,i),o=T(t,i,e);return d.isArray(e[i.id])||(e[i.id]=[]),i.status=1,s.length&&(a=(n=t.find(i.container)).find(i.error),k(t,i,o),n="input"===r.settings.validationStateOn?s:n,o?(i.encodeError?a.text(e[i.id][0]):a.html(e[i.id][0]),n.removeClass(r.settings.validatingCssClass+" "+r.settings.successCssClass).addClass(r.settings.errorCssClass)):(a.empty(),n.removeClass(r.settings.validatingCssClass+" "+r.settings.errorCssClass+" ").addClass(r.settings.successCssClass)),i.value=E(t,i)),t.trigger(u,[i,e[i.id]]),o},T=function(t,i,e){var a=D(t,i),t=!1;return d.isArray(e[i.id])||(e[i.id]=[]),a.length&&(t=0<e[i.id].length),t},S=function(t,i){var e=t.data("yiiActiveForm"),t=t.find(e.settings.errorSummary),a=t.find("ul").empty();t.length&&i&&(d.each(e.attributes,function(){var t;d.isArray(i[this.id])&&i[this.id].length&&(t=d("<li/>"),e.settings.encodeErrorSummary?t.text(i[this.id][0]):t.html(i[this.id][0]),a.append(t))}),t.toggle(0<a.find("li").length))},E=function(t,i){var e=D(t,i),i=e.attr("type");if("checkbox"!==i&&"radio"!==i)return e.val();var a=e.filter(":checked");if(1<a.length){var n=[];return a.each(function(t){n.push(d(a.get(t)).val())}),n}return a.length||(a=t.find('input[type=hidden][name="'+e.attr("name")+'"]')),a.val()},D=function(t,i){i=t.find(i.input);return i.length&&"div"===i[0].tagName.toLowerCase()?i.find("input"):i},k=function(t,i,e){i.updateAriaInvalid&&t.find(i.input).attr("aria-invalid",e?"true":"false")}}(window.jQuery);